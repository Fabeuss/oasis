CREATE TABLE IF NOT EXISTS site (
	id INTEGER PRIMARY KEY,
	version REAL NOT NULL DEFAULT 0.1,
	first_run INTEGER NOT NULL DEFAULT 1,
	port INTEGER NOT NULL DEFAULT 3000,
	allow_guest INTEGER NOT NULL DEFAULT 1,
    default_user_group INTEGER NOT NULL DEFAULT 2,
	language INTEGER NOT NULL DEFAULT 1,
	create_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS language (
	id INTEGER PRIMARY KEY,
	code TEXT NOT NULL UNIQUE,
   	language_name TEXT NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS usergroup (
	id INTEGER PRIMARY KEY,
   	group_name TEXT NOT NULL UNIQUE,
	power INTEGER NOT NULL,
    status INTEGER NOT NULL DEFAULT 1
);

CREATE TABLE IF NOT EXISTS user (
	id INTEGER PRIMARY KEY,
   	username TEXT NOT NULL UNIQUE,
    password TEXT NOT NULL,
	usergroup INTEGER
);

CREATE TABLE IF NOT EXISTS category (
	id INTEGER PRIMARY KEY,
   	category_name TEXT NOT NULL UNIQUE,
	permission INTEGER NOT NULL DEFAULT 1,
	seq INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS storage (
	id INTEGER PRIMARY KEY,
   	storage_name TEXT NOT NULL UNIQUE,
	path TEXT NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS item (
	id INTEGER PRIMARY KEY,
    parent INTEGER,
   	item_name TEXT NOT NULL,
	type INTEGER NOT NULL,
    category INTEGER NOT NULL DEFAULT 0,
    permission INTEGER NOT NULL,
    descriptoin TEXT,
	thumbnail TEXT
);

CREATE TABLE IF NOT EXISTS file (
	id INTEGER PRIMARY KEY,
    item INTEGER NOT NULL,
    storage INTEGER NOT NULL,
	path TEXT NOT NULL,
   	filename TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS cast (
	id INTEGER PRIMARY KEY,
   	cast_name TEXT NOT NULL,
	description TEXT,
    permission INTEGER NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS itemcast (
	id INTEGER PRIMARY KEY,
   	item INTEGER NOT NULL,
	cast INTEGER NOT NULL,
    type TEXT,
    seq INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS tag (
	id INTEGER PRIMARY KEY,
    tag_name TEXT NOT NULL UNIQUE,
    permission INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS itemtag (
	id INTEGER PRIMARY KEY,
   	item INTEGER NOT NULL,
	tag INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS star (
	id INTEGER PRIMARY KEY,
	user INTEGER NOT NULL,
	item INTEGER NOT NULL,
	create_at DATE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS history (
	id INTEGER PRIMARY KEY,
	user INTEGER NOT NULL,
	item INTEGER NOT NULL,
	progress REAL NOT NULL DEFAULT 0,
	create_at DATE DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO language(code, language_name) VALUES('en', 'English');
INSERT INTO language(code, language_name) VALUES('cn', '中文');
INSERT INTO site(create_at) VALUES(datetime());
INSERT INTO usergroup(group_name, power) VALUES('Admin', 9);
INSERT INTO usergroup(group_name, power) VALUES('User', 3);
INSERT INTO category(category_name, seq) VALUES('Movie', 1);
INSERT INTO category(category_name, seq) VALUES('TV series', 2);